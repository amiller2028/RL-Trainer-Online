// RLTrainerOnline - https://github.com/amiller2028/RL-Trainer-Online

window.game=window.game||{},window.game.static={colors:{black:0,white:16777215,green:1039244,cyan:3735001}},window.game=window.game||{},window.game.three=function(){var e={domContainer:null,cameraSizeConstraint:null,camera:null,scene:null,renderer:null,fov:45,init:function(a){e.domContainer=a&&a.domContainer||document.createElement("div"),e.cameraSizeConstraint={width:a&&a.cameraSizeConstraint&&a.cameraSizeConstraint.width||0,height:a&&a.cameraSizeConstraint&&a.cameraSizeConstraint.height||0},a&&a.domContainer||document.body.appendChild(e.domContainer),e.setup(),e.camera=new THREE.PerspectiveCamera(e.fov,(window.innerWidth-e.cameraSizeConstraint.width)/(window.innerHeight-e.cameraSizeConstraint.height),1,15e3),e.camera.up.set(0,0,1),e.renderer=new THREE.WebGLRenderer({antialias:!0}),a&&"number"==typeof a.rendererClearColor&&e.renderer.setClearColor(a.rendererClearColor,1),e.onWindowResize(),window.addEventListener("resize",e.onWindowResize,!1),e.domContainer.appendChild(e.renderer.domElement)},destroy:function(){},setup:function(){e.scene=new THREE.Scene,e.setupLights&&e.setupLights()},render:function(){e.renderer.render(e.scene,e.camera)},onWindowResize:function(){e.camera.aspect=(window.innerWidth-e.cameraSizeConstraint.width)/(window.innerHeight-e.cameraSizeConstraint.height),e.camera.updateProjectionMatrix(),e.renderer.setSize(window.innerWidth-e.cameraSizeConstraint.width,window.innerHeight-e.cameraSizeConstraint.height)},createModel:function(a,n,r,o){var i,t,s={};if(i=o?a:(new THREE.JSONLoader).parse(JSON.parse(JSON.stringify(a))),e.createCannonGeometry(i.geometry,n),s.halfExtents=e.createCannonHalfExtents(i.geometry),r)if("object"==typeof r&&r.length){if(i.materials){for(var l=0;l<i.materials.length;l++)i.materials[l]=r[l];t=new THREE.MeshFaceMaterial(i.materials)}}else t=r;else i.materials&&(t=new THREE.MeshFaceMaterial(i.materials));return s.mesh=new THREE.Mesh(i.geometry,t),s},createCannonGeometry:function(e,a){var n,r,o;e.computeBoundingBox(),n=-(e.boundingBox.size().x/2+e.boundingBox.min.x),r=-(e.boundingBox.size().y/2+e.boundingBox.min.y),o=-(e.boundingBox.size().z/2+e.boundingBox.min.z),e.applyMatrix((new THREE.Matrix4).makeTranslation(n,r,o)),e.applyMatrix((new THREE.Matrix4).makeRotationAxis(new THREE.Vector3(1,0,0),Math.PI/2)),e.applyMatrix((new THREE.Matrix4).makeScale(a,a,a))},createCannonHalfExtents:function(e){return e.computeBoundingBox(),new CANNON.Vec3(.5*(e.boundingBox.max.x-e.boundingBox.min.x),.5*(e.boundingBox.max.y-e.boundingBox.min.y),.5*(e.boundingBox.max.z-e.boundingBox.min.z))}};return e},window.game=window.game||{},window.game.cannon=function(){var e,a={world:null,bodies:[],visuals:[],bodyCount:0,friction:0,restitution:0,gravity:-10,timestep:1/8,playerPhysicsMaterial:null,solidMaterial:null,init:function(n){a.overrideCollisionMatrixSet(),a.setup(),e=n},destroy:function(){a.removeAllVisuals()},setup:function(){a.world=new CANNON.World,a.world.gravity.set(0,0,a.gravity),a.world.broadphase=new CANNON.NaiveBroadphase,a.world.solver.iterations=5,a.bodies=[],a.visuals=[],a.bodyCount=0},overrideCollisionMatrixSet:function(){var e=CANNON.World.prototype.collisionMatrixSet;CANNON.World.prototype.collisionMatrixSet=function(a,n,r,o){e.call(this,a,n,[a,n],o)}},getCollisions:function(e){for(var n=0,r=0;r<a.world.collisionMatrix.length;r++)a.world.collisionMatrix[r]&&a.world.collisionMatrix[r].length&&(a.world.collisionMatrix[r][0]===e||a.world.collisionMatrix[r][1]===e)&&n++;return n},rotateOnAxis:function(e,a,n){var r=new CANNON.Quaternion;r.setFromAxisAngle(a,n),e.quaternion=r.mult(e.quaternion)},createRigidBody:function(e){var n=new CANNON.RigidBody(e.mass,e.shape,e.physicsMaterial);return n.position.set(e.position.x,e.position.y,e.position.z),e.rotation&&n.quaternion.setFromAxisAngle(e.rotation[0],e.rotation[1]),a.addVisual(n,e.meshMaterial,e.customMesh),n},createPhysicsMaterial:function(e,n,r){var o=e||new CANNON.Material,i=new CANNON.ContactMaterial(o,a.playerPhysicsMaterial,n||a.friction,r||a.restitution);return a.world.addContactMaterial(i),o},addVisual:function(n,r,o){var i=o||null;return n instanceof CANNON.RigidBody&&!i&&(i=a.shape2mesh(n.shape,r)),i&&(a.bodies.push(n),a.visuals.push(i),n.visualref=i,n.visualref.visualId=a.bodies.length-1,e.scene.add(i),a.world.add(n)),i},removeVisual:function(n){if(n.visualref){for(var r=[],o=[],i=a.bodies.length,t=0;t<i;t++)r.unshift(a.bodies.pop()),o.unshift(a.visuals.pop());for(var s=n.visualref.visualId,l=0;l<r.length;l++)if(l!==s){t=l>s?l-1:l;a.bodies[t]=r[l],a.visuals[t]=o[l],a.bodies[t].visualref=r[l].visualref,a.bodies[t].visualref.visualId=t}n.visualref.visualId=null,e.scene.remove(n.visualref),n.visualref=null,a.world.remove(n)}},removeAllVisuals:function(){a.bodies.forEach(function(n){n.visualref&&(n.visualref.visualId=null,e.scene.remove(n.visualref),n.visualref=null,a.world.remove(n))}),a.bodies=[],a.visuals=[]},updatePhysics:function(){a.bodyCount=a.bodies.length;for(var e=0;e<a.bodyCount;e++){var n=a.bodies[e],r=a.visuals[e];n.position.copy(r.position),n.quaternion&&n.quaternion.copy(r.quaternion)}a.world.step(a.timestep)},shape2mesh:function(e,n){var r,o;switch(e.type){case CANNON.Shape.types.SPHERE:var i=new THREE.SphereGeometry(e.radius,e.wSeg,e.hSeg);r=new THREE.Mesh(i,n);break;case CANNON.Shape.types.PLANE:var t=new THREE.PlaneGeometry(100,100);r=new THREE.Object3D,o=new THREE.Object3D;var s=new THREE.Mesh(t,n);s.scale=new THREE.Vector3(1e3,1e3,1e3),o.add(s),s.castShadow=!0,s.receiveShadow=!0,r.add(o);break;case CANNON.Shape.types.BOX:var l=new THREE.CubeGeometry(2*e.halfExtents.x,2*e.halfExtents.y,2*e.halfExtents.z);(r=new THREE.Mesh(l,n)).castShadow=!0,r.receiveShadow=!0;break;case CANNON.Shape.types.COMPOUND:for(var d=new THREE.Object3D,c=0;c<e.childShapes.length;c++){var p=e.childShapes[c],y=e.childOffsets[c],u=e.childOrientations[c];(o=a.shape2mesh(p)).position.set(y.x,y.y,y.z),o.quaternion.set(u.x,u.y,u.z,u.w),o.useQuaternion=!0,d.add(o),r=d}break;default:throw"Visual type not recognized: "+e.type}if(r.receiveShadow=!0,r.castShadow=!0,r.children)for(c=0;c<r.children.length;c++)if(r.children[c].castShadow=!0,r.children[c].receiveShadow=!0,r.children[c])for(var m=0;m<r.children[c].length;m++)r.children[c].children[m].castShadow=!0,r.children[c].children[m].receiveShadow=!0;return r},showAABBs:function(){var n=this,r=new THREE.CubeGeometry(1,1,1),o=new THREE.MeshBasicMaterial({color:16777215,wireframe:!0}),i=new function(a){var n=null,r=[],o=[];this.request=function(){return n=r.length?r.pop():a(),e.scene.add(n),o.push(n),n},this.restart=function(){for(;o.length;)r.push(o.pop())},this.hideCached=function(){for(var a=0;a<r.length;a++)e.scene.remove(r[a])}}(function(){return new THREE.Mesh(r,o)});return n.update=function(){i.restart();for(var e=0;e<a.bodies.length;e++){var n=a.bodies[e];if(n.computeAABB&&(n.aabbNeedsUpdate&&n.computeAABB(),isFinite(n.aabbmax.x)&&isFinite(n.aabbmax.y)&&isFinite(n.aabbmax.z)&&isFinite(n.aabbmin.x)&&isFinite(n.aabbmin.y)&&isFinite(n.aabbmin.z)&&n.aabbmax.x-n.aabbmin.x!=0&&n.aabbmax.y-n.aabbmin.y!=0&&n.aabbmax.z-n.aabbmin.z!=0)){var r=i.request();r.scale.set(n.aabbmax.x-n.aabbmin.x,n.aabbmax.y-n.aabbmin.y,n.aabbmax.z-n.aabbmin.z),r.position.set(.5*(n.aabbmax.x+n.aabbmin.x),.5*(n.aabbmax.y+n.aabbmin.y),.5*(n.aabbmax.z+n.aabbmin.z))}}i.hideCached()},n.init=function(){var e=a.updatePhysics;a.updatePhysics=function(){e(),n.update()}},n}};return a},window.game=window.game||{},window.game.events=function(){var e={keyboard:{keyCodes:{32:"space",65:"a",68:"d",83:"s",87:"w"},pressed:{},onKeyDown:function(a){e.keyboard.pressed[e.keyboard.keyCodes[a.keyCode]]=!0,e.onKeyDown()},onKeyUp:function(a){e.keyboard.pressed[e.keyboard.keyCodes[a.keyCode]]=!1}},init:function(){document.addEventListener("keydown",e.keyboard.onKeyDown,!1),document.addEventListener("keyup",e.keyboard.onKeyUp,!1)},onKeyDown:function(){}};return e},window.game=window.game||{},window.game.helpers={polarToCartesian:function(e,a){return{x:e*Math.cos(a),y:e*Math.sin(a)}},radToDeg:function(e){return e*(180/Math.PI)},degToRad:function(e){return e*Math.PI/180},random:function(e,a,n){return n?Math.floor(Math.random()*(a+1))+e:Math.random()*a+e},cloneObject:function(e){var a;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return(a=new Date).setTime(e.getTime()),a;if(e instanceof Array){a=[];for(var n=0,r=e.length;n<r;n++)a[n]=window.game.helpers.cloneObject(e[n]);return a}if(e instanceof Object){a={};for(var o in e)e.hasOwnProperty(o)&&(a[o]=window.game.helpers.cloneObject(e[o]));return a}}},window.game=window.game||{},window.game.ui=function(){var e={elements:{infoboxIntro:null},init:function(){e.getElements(),e.bindEvents()},destroy:function(){},getElements:function(){e.elements.infoboxIntro=document.querySelector("#infobox-intro")},bindEvents:function(){},fadeOut:function(a){e.hasClass(a,"fade-out")||e.addClass(a,"fade-out")},addClass:function(a,n,r){r&&e.elements[a].getAttribute("data-classname")&&(e.elements[a].className=r&&e.elements[a].getAttribute("data-classname")),e.elements[a].className=e.elements[a].className+" "+n},removeClass:function(a,n){var r=new RegExp("\\s\\b"+n+"\\b","gi");e.elements[a].className=e.elements[a].className.replace(r,"")},hasClass:function(a,n){return e.elements[a].className.match(n)}};return e},window.game=window.game||{},window.game.models={player:{metadata:{formatVersion:3.1,generatedBy:"Blender 2.65 Exporter",vertices:56,faces:52,normals:56,colors:0,uvs:[],materials:1,morphTargets:0,bones:0},scale:1,materials:[{DbgColor:15658734,DbgIndex:0,DbgName:"cyan",blending:"NormalBlending",colorAmbient:[.039546236395835876,.9822506308555603,.6938718557357788],colorDiffuse:[.039546236395835876,.9822506308555603,.6938718557357788],colorSpecular:[1,1,1],depthTest:!0,depthWrite:!0,shading:"Lambert",specularCoef:50,transparency:1,transparent:!1,vertexColors:!1},{DbgColor:15597568,DbgIndex:1,DbgName:"green",blending:"NormalBlending",colorAmbient:[.004776954650878906,.708375871181488,.2622506618499756],colorDiffuse:[.004776954650878906,.708375871181488,.2622506618499756],colorSpecular:[1,1,1],depthTest:!0,depthWrite:!0,shading:"Lambert",specularCoef:50,transparency:1,transparent:!1,vertexColors:!1}],vertices:[.205423,.203889,.163399,.205423,.203889,-.163399,-.836746,-.0273734,.0852706,-.836746,-.0273734,-.0852706,.00547919,.231254,.105459,.00547919,.231253,-.105459,-.667144,.0819949,.0550342,-.667144,.0819949,-.0550342,-.539983,-.13177,.198399,-.539983,-.13177,-.198399,.734445,-.132315,-.26534,.734445,-.132315,.26534,.205423,.203889,.163399,.205423,.203889,-.163399,.734445,.14159,-.194793,.734445,.14159,.194793,-.836746,-.109792,.0852706,-.836746,-.109792,-.0852706,-.836746,-.0273734,.0852706,-.836746,-.0273734,-.0852706,.817604,-.0864622,-.174778,.817604,-.0864621,.174778,.817604,.0957368,-.174778,.817604,.0957368,.174778,.817604,-.0864621,-.102738,.817604,-.0864621,.102738,.817604,.0957368,-.102738,.817604,.0957368,.102738,.256034,-.0825444,-.119579,.256034,-.0825444,.119579,.256034,.101471,-.119579,.256034,.101471,.119579,-.0492363,.0232588,.36925,-.0492363,.0232588,-.36925,.686899,-.0452344,-.355008,.686899,-.0452344,.355008,.11323,.0768929,.376715,.11323,.0768929,-.376715,.686899,.0571518,-.355008,.686899,.0571518,.355008,.418567,-.0924264,.793526,.418567,-.0924264,-.793526,.785102,-.0793208,-.790767,.785102,-.0793208,.790767,.418567,-.077483,.793526,.418567,-.0774831,-.793526,.785102,-.0558296,-.790767,.785102,-.0558296,.790767,.261471,.197289,.100715,.261471,.197289,-.100715,.678397,.14819,-.120066,.678397,.14819,.120066,.526158,.323654,.02321,.526158,.323654,-.02321,.85976,.274555,-.0276693,.85976,.274555,.0276693],morphTargets:[],normals:[.78103,.039796,-.623218,-.769738,-.313486,-.556047,-.333659,.836451,-.434706,-.105533,.891568,-.440413,-.105533,.891568,.440413,-.333659,.836451,.434706,.78103,.039796,.623218,-.769738,-.313486,.556047,-.224982,-.534013,.814966,-.074679,.965636,.248848,-.624805,.646779,.4373,-.726859,-.446181,.52205,-.421155,.163549,.892087,-.225135,.868618,.441328,.471755,-.708945,.524186,.471755,-.708945,-.524186,.842586,-.402997,-.357219,.842586,-.402997,.357219,.458266,.80108,.384991,.648396,.665242,.370128,.720054,-.608722,.33311,-.224982,-.534013,-.814966,.240608,.900571,.362011,824e-6,.996063,.088534,-.624805,.646779,-.4373,-.726859,-.446181,-.52205,-.074679,.965636,-.248848,.813654,-.366131,.451521,.813654,-.366131,-.451521,.819208,.418744,.391797,.458266,.80108,-.384991,.819208,.418744,-.391797,.571184,.573595,.587115,.571184,.573595,-.587115,.487442,.607013,-.627613,.487442,.607013,.627613,.566759,-.578936,.586138,.566759,-.578936,-.586138,.665456,.488449,.564379,.628651,-.604236,.489547,.648396,.665242,-.370128,.720054,-.608722,-.33311,.628651,-.604236,-.489547,.665456,.488449,-.564379,-.225135,.868618,-.441328,-.421155,.163549,-.892087,-.127781,.7163,-.685965,-.241432,-.530503,-.812555,-.127781,.7163,.685965,-.241432,-.530503,.812555,.864315,.221686,.45143,-.091922,.898251,.429701,.240608,.900571,-.362011,824e-6,.996063,-.088534,.864315,.221686,-.45143,-.091922,.898251,-.429701],colors:[],uvs:[],faces:[35,1,3,7,5,0,0,1,2,3,35,4,5,7,6,0,4,3,2,5,35,0,1,5,4,0,6,0,3,4,35,2,0,4,6,0,7,6,4,5,35,3,2,6,7,0,1,7,5,2,35,0,2,3,1,0,6,7,1,0,35,8,12,18,16,1,8,9,10,11,35,12,8,32,36,1,9,8,12,13,35,11,10,20,21,1,14,15,16,17,35,11,15,39,35,1,14,18,19,20,35,8,9,10,11,1,8,21,15,14,35,12,15,51,48,1,9,18,22,23,35,18,19,17,16,1,10,24,25,11,35,9,8,16,17,1,21,8,11,25,35,13,9,17,19,1,26,21,25,24,35,21,20,24,25,1,17,16,27,28,35,15,11,21,23,1,18,14,17,29,35,10,14,22,20,1,15,30,31,16,35,14,15,23,22,1,30,18,29,31,35,25,24,28,29,1,28,27,32,33,35,22,23,27,26,1,31,29,34,35,35,23,21,25,27,1,29,17,28,34,35,20,22,26,24,1,16,31,35,27,35,30,31,29,28,1,36,37,33,32,35,24,26,30,28,1,27,35,36,32,35,26,27,31,30,1,35,34,37,36,35,27,25,29,31,1,34,28,33,37,35,35,39,47,43,1,20,19,38,39,35,38,34,42,46,1,40,41,42,43,35,15,12,36,39,1,18,9,13,19,35,14,10,34,38,1,30,15,41,40,35,13,14,38,37,1,26,30,40,44,35,8,11,35,32,1,8,14,20,12,35,10,9,33,34,1,15,21,45,41,35,9,13,37,33,1,21,26,44,45,35,45,46,42,41,1,46,43,42,47,35,47,44,40,43,1,38,48,49,39,35,33,37,45,41,1,45,44,46,47,35,32,35,43,40,1,12,20,39,49,35,37,38,46,45,1,44,40,43,46,35,34,33,41,42,1,41,45,47,42,35,39,36,44,47,1,19,13,48,38,35,36,32,40,44,1,13,12,49,48,35,18,12,13,19,1,10,9,26,24,35,48,51,55,52,1,23,22,50,51,35,15,14,50,51,1,18,30,52,22,35,14,13,49,50,1,30,26,53,52,35,13,12,48,49,1,26,9,23,53,35,55,54,53,52,1,50,54,55,51,35,50,49,53,54,1,52,53,55,54,35,51,50,54,55,1,22,52,54,50,35,49,48,52,53,1,53,23,51,55],bones:[],skinIndices:[],skinWeights:[],animation:{}}},window.game=window.game||{},window.game.core=function(){var e,a,n,r,o,i={player:{model:null,mesh:null,shape:null,rigidBody:null,orientationConstraint:null,mass:3,isGrounded:!1,jumpHeight:38,speed:1.5,speedMax:45,rotationSpeed:.007,rotationSpeedMax:.04,rotationRadians:new THREE.Vector3(0,0,0),rotationAngleX:null,rotationAngleY:null,damping:.9,rotationDamping:.8,acceleration:0,rotationAcceleration:0,playerCoords:null,cameraCoords:null,cameraOffsetH:240,cameraOffsetV:140,playerAccelerationValues:{position:{acceleration:"acceleration",speed:"speed",speedMax:"speedMax"},rotation:{acceleration:"rotationAcceleration",speed:"rotationSpeed",speedMax:"rotationSpeedMax"}},controlKeys:{forward:"w",backward:"s",left:"a",right:"d"},create:function(){n.playerPhysicsMaterial=new CANNON.Material("playerMaterial"),i.player.model=a.createModel(window.game.models.player,12,[new THREE.MeshLambertMaterial({color:window.game.static.colors.cyan,shading:THREE.FlatShading}),new THREE.MeshLambertMaterial({color:window.game.static.colors.green,shading:THREE.FlatShading})]),i.player.shape=new CANNON.Box(i.player.model.halfExtents),i.player.rigidBody=new CANNON.RigidBody(i.player.mass,i.player.shape,n.createPhysicsMaterial(n.playerPhysicsMaterial)),i.player.rigidBody.position.set(0,0,50),i.player.mesh=n.addVisual(i.player.rigidBody,null,i.player.model.mesh),i.player.orientationConstraint=new CANNON.HingeConstraint(i.player.rigidBody,new CANNON.Vec3(0,0,0),new CANNON.Vec3(0,0,1),i.player.rigidBody,new CANNON.Vec3(0,0,1),new CANNON.Vec3(0,0,1)),n.world.addConstraint(i.player.orientationConstraint),i.player.rigidBody.postStep=function(){i.player.rigidBody.angularVelocity.z=0,i.player.updateOrientation()},i.player.rigidBody.addEventListener("collide",function(e){i.player.isGrounded||(i.player.isGrounded=new CANNON.Ray(i.player.mesh.position,new CANNON.Vec3(0,0,-1)).intersectBody(e.contact.bi).length>0)})},update:function(){i.player.processUserInput(),i.player.accelerate(),i.player.rotate(),i.player.updateCamera(),i.player.checkGameOver()},updateCamera:function(){i.player.cameraCoords=window.game.helpers.polarToCartesian(i.player.cameraOffsetH,i.player.rotationRadians.z),a.camera.position.x=i.player.mesh.position.x+i.player.cameraCoords.x,a.camera.position.y=i.player.mesh.position.y+i.player.cameraCoords.y,a.camera.position.z=i.player.mesh.position.z+i.player.cameraOffsetV,a.camera.lookAt(i.player.mesh.position)},updateAcceleration:function(e,a){1===a?i.player[e.acceleration]>-i.player[e.speedMax]?i.player[e.acceleration]>=i.player[e.speedMax]/2?i.player[e.acceleration]=-i.player[e.speedMax]/4:i.player[e.acceleration]-=i.player[e.speed]:i.player[e.acceleration]=-i.player[e.speedMax]:i.player[e.acceleration]<i.player[e.speedMax]?i.player[e.acceleration]<=-i.player[e.speedMax]/2?i.player[e.acceleration]=i.player[e.speedMax]/4:i.player[e.acceleration]+=i.player[e.speed]:i.player[e.acceleration]=i.player[e.speedMax]},processUserInput:function(){e.keyboard.pressed.space&&i.player.jump(),e.keyboard.pressed[i.player.controlKeys.forward]&&(i.player.updateAcceleration(i.player.playerAccelerationValues.position,1),n.getCollisions(i.player.rigidBody.index)||i.player.rigidBody.quaternion.setFromAxisAngle(new CANNON.Vec3(0,0,1),i.player.rotationRadians.z)),e.keyboard.pressed[i.player.controlKeys.backward]&&i.player.updateAcceleration(i.player.playerAccelerationValues.position,-1),e.keyboard.pressed[i.player.controlKeys.right]&&i.player.updateAcceleration(i.player.playerAccelerationValues.rotation,1),e.keyboard.pressed[i.player.controlKeys.left]&&i.player.updateAcceleration(i.player.playerAccelerationValues.rotation,-1)},accelerate:function(){i.player.playerCoords=window.game.helpers.polarToCartesian(i.player.acceleration,i.player.rotationRadians.z),i.player.rigidBody.velocity.set(i.player.playerCoords.x,i.player.playerCoords.y,i.player.rigidBody.velocity.z),e.keyboard.pressed[i.player.controlKeys.forward]||e.keyboard.pressed[i.player.controlKeys.backward]||(i.player.acceleration*=i.player.damping)},rotate:function(){n.rotateOnAxis(i.player.rigidBody,new CANNON.Vec3(0,0,1),i.player.rotationAcceleration),e.keyboard.pressed[i.player.controlKeys.left]||e.keyboard.pressed[i.player.controlKeys.right]||(i.player.rotationAcceleration*=i.player.rotationDamping)},jump:function(){n.getCollisions(i.player.rigidBody.index)&&i.player.isGrounded&&(i.player.isGrounded=!1,i.player.rigidBody.velocity.z=i.player.jumpHeight)},updateOrientation:function(){i.player.rotationRadians=(new THREE.Euler).setFromQuaternion(i.player.rigidBody.quaternion),i.player.rotationAngleX=Math.round(window.game.helpers.radToDeg(i.player.rotationRadians.x)),i.player.rotationAngleY=Math.round(window.game.helpers.radToDeg(i.player.rotationRadians.y)),n.getCollisions(i.player.rigidBody.index)&&(i.player.rotationAngleX>=90||i.player.rotationAngleX<=-90||i.player.rotationAngleY>=90||i.player.rotationAngleY<=-90)&&i.player.rigidBody.quaternion.setFromAxisAngle(new CANNON.Vec3(0,0,1),i.player.rotationRadians.z)},checkGameOver:function(){i.player.mesh.position.z<=-800&&i.destroy()}},level:{create:function(){n.solidMaterial=n.createPhysicsMaterial(new CANNON.Material("solidMaterial"),0,.1);n.createRigidBody({shape:new CANNON.Box(new CANNON.Vec3(800,800,20)),mass:0,position:new CANNON.Vec3(0,0,-20),meshMaterial:new THREE.MeshLambertMaterial({color:window.game.static.colors.black}),physicsMaterial:n.solidMaterial}),n.createRigidBody({shape:new CANNON.Box(new CANNON.Vec3(30,30,30)),mass:0,position:new CANNON.Vec3(-240,-200,29),meshMaterial:new THREE.MeshLambertMaterial({color:window.game.static.colors.cyan}),physicsMaterial:n.solidMaterial}),n.createRigidBody({shape:new CANNON.Box(new CANNON.Vec3(30,30,30)),mass:0,position:new CANNON.Vec3(-300,-260,90),meshMaterial:new THREE.MeshLambertMaterial({color:window.game.static.colors.cyan}),physicsMaterial:n.solidMaterial}),n.createRigidBody({shape:new CANNON.Box(new CANNON.Vec3(30,30,30)),mass:0,position:new CANNON.Vec3(-180,-200,150),meshMaterial:new THREE.MeshLambertMaterial({color:window.game.static.colors.cyan}),physicsMaterial:n.solidMaterial}),n.createRigidBody({shape:new CANNON.Box(new CANNON.Vec3(30,30,30)),mass:0,position:new CANNON.Vec3(-120,-140,210),meshMaterial:new THREE.MeshLambertMaterial({color:window.game.static.colors.cyan}),physicsMaterial:n.solidMaterial}),n.createRigidBody({shape:new CANNON.Box(new CANNON.Vec3(30,30,30)),mass:0,position:new CANNON.Vec3(-60,-80,270),meshMaterial:new THREE.MeshLambertMaterial({color:window.game.static.colors.cyan}),physicsMaterial:n.solidMaterial});var e=new THREE.GridHelper(800,80);e.position.z=.5,e.rotation.x=window.game.helpers.degToRad(90),a.scene.add(e)}},init:function(e){i.initComponents(e),i.player.create(),i.level.create(),i.loop()},destroy:function(){window.cancelAnimationFrame(o),n.destroy(),n.setup(),a.destroy(),a.setup(),i.player=window.game.helpers.cloneObject(t.player),i.level=window.game.helpers.cloneObject(t.level),i.player.create(),i.level.create(),i.loop()},loop:function(){o=window.requestAnimationFrame(i.loop),n.updatePhysics(),i.player.update(),a.render()},initComponents:function(o){e=window.game.events(),a=window.game.three(),n=window.game.cannon(),r=window.game.ui(),a.setupLights=function(){var e=new THREE.HemisphereLight(window.game.static.colors.white,window.game.static.colors.white,.6);e.position.set(0,0,-1),a.scene.add(e);var n=new THREE.PointLight(window.game.static.colors.white,.5);n.position.set(0,0,500),a.scene.add(n)},a.init(o),n.init(a),r.init(),e.init(),e.onKeyDown=function(){r.hasClass("infoboxIntro","fade-out")||r.fadeOut("infoboxIntro")}}},t={player:window.game.helpers.cloneObject(i.player),level:window.game.helpers.cloneObject(i.level)};return i};